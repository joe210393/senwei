<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>預約報名管理</title>
  <link rel="stylesheet" href="/css/admin.css">
  <link rel="stylesheet" href="/css/site.css">
  <script defer src="/js/admin.js"></script>
</head>
<body>
  <div id="admin-header"></div>
  <main class="container" style="padding:24px;">
    <h1>預約報名管理</h1>
    
    <div class="card" style="margin-bottom:24px;">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
        <h2 style="margin:0;">月曆視圖</h2>
        <div style="display:flex;gap:8px;">
          <button id="prev-month" class="btn ghost">‹ 上個月</button>
          <span id="current-month" style="font-weight:600;min-width:200px;text-align:center;"></span>
          <button id="next-month" class="btn ghost">下個月 ›</button>
        </div>
      </div>
      <div id="admin-calendar" style="display:grid;grid-template-columns:repeat(7,1fr);gap:8px;">
        <!-- Calendar will be rendered here -->
      </div>
      <style>
        #admin-calendar .calendar-day-header {
          text-align: center;
          font-weight: 600;
          padding: 8px;
          color: #666;
          font-size: 14px;
          background: #f9fafb;
          border-radius: 4px;
        }
        #admin-calendar .calendar-day {
          aspect-ratio: 1;
          border: 1px solid #e5e7eb;
          border-radius: 8px;
          padding: 8px;
          cursor: pointer;
          transition: all 0.2s;
          background: #fff;
          position: relative;
          min-height: 80px;
        }
        #admin-calendar .calendar-day:hover {
          border-color: #111827;
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        #admin-calendar .calendar-day.other-month {
          opacity: 0.3;
          background: #f9fafb;
        }
        #admin-calendar .calendar-day.today {
          border-color: #111827;
          border-width: 2px;
          font-weight: 700;
        }
        #admin-calendar .calendar-day-number {
          font-size: 14px;
          margin-bottom: 4px;
          font-weight: 600;
        }
        #admin-calendar .calendar-day-events {
          display: flex;
          flex-direction: column;
          gap: 2px;
          font-size: 10px;
        }
        #admin-calendar .event-dot {
          width: 6px;
          height: 6px;
          border-radius: 50%;
          display: inline-block;
          margin-right: 2px;
        }
        #admin-calendar .event-dot.course { background: #4A90E2; }
        #admin-calendar .event-dot.performance { background: #E94B3C; }
        #admin-calendar .event-dot.space { background: #7B68EE; }
      </style>
    </div>
    
    <div class="card">
      <h2 style="margin-top:0;">活動列表</h2>
      <div style="margin-bottom:16px;">
        <button id="create-event-btn" class="btn">新增活動</button>
      </div>
      <table id="events-table" style="width:100%;border-collapse:collapse;">
        <thead>
          <tr style="border-bottom:2px solid #e5e7eb;">
            <th style="text-align:left;padding:8px;">日期</th>
            <th style="text-align:left;padding:8px;">類型</th>
            <th style="text-align:left;padding:8px;">標題</th>
            <th style="text-align:left;padding:8px;">時間</th>
            <th style="text-align:left;padding:8px;">狀態</th>
            <th style="text-align:left;padding:8px;">操作</th>
          </tr>
        </thead>
        <tbody id="events-tbody"></tbody>
      </table>
    </div>
    
    <!-- Event Form Modal -->
    <div id="event-form-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;padding:24px;">
      <div class="card" style="max-width:900px;width:100%;max-height:90vh;overflow-y:auto;">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
          <h2 id="event-form-title" style="margin:0;">新增活動</h2>
          <button id="close-event-form" class="btn ghost" style="padding:4px 8px;">✕</button>
        </div>
        <form id="event-form">
          <input type="hidden" name="id" id="event-id">
          
          <!-- 活動資訊區塊 -->
          <div style="margin-bottom:24px;padding-bottom:24px;border-bottom:1px solid #e5e7eb;">
            <h3 style="margin:0 0 16px 0;font-size:18px;">活動資訊</h3>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
              <label>
                類型 <span style="color:#c00;">*</span>
                <select name="event_type" id="event-type" required>
                  <option value="course">音樂課程</option>
                  <option value="performance">商業演出</option>
                  <option value="space">共享空間租借</option>
                </select>
              </label>
              <label>
                標題 <span style="color:#c00;">*</span>
                <input type="text" name="title" id="event-title" required placeholder="例如：爵士鼓基礎課程">
              </label>
              <label>
                開始時間
                <input type="time" name="start_time" id="event-start-time">
              </label>
              <label>
                結束時間
                <input type="time" name="end_time" id="event-end-time">
              </label>
              <label>
                最大參與人數
                <input type="number" name="max_participants" id="event-max-participants" min="1">
              </label>
              <label style="display:flex;align-items:center;gap:8px;padding-top:24px;">
                <input type="checkbox" name="is_active" id="event-is-active" checked>
                <span>啟用</span>
              </label>
            </div>
            <label style="margin-top:16px;display:block;">
              描述
              <textarea name="description" id="event-description" rows="3" placeholder="活動詳細說明..."></textarea>
            </label>
          </div>
          
          <!-- 日期選擇區塊 -->
          <div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
              <h3 style="margin:0;font-size:18px;">選擇日期 <span style="color:#c00;">*</span></h3>
              <div style="display:flex;gap:8px;">
                <button type="button" id="date-picker-prev-month" class="btn ghost sm">‹ 上個月</button>
                <span id="date-picker-month" style="font-weight:600;min-width:150px;text-align:center;"></span>
                <button type="button" id="date-picker-next-month" class="btn ghost sm">下個月 ›</button>
              </div>
            </div>
            <div id="date-picker-calendar" style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:16px;">
              <!-- 日期選擇日曆將在這裡渲染 -->
            </div>
            <div id="selected-dates-list" style="margin-top:16px;padding:12px;background:#f9fafb;border-radius:8px;min-height:40px;">
              <div style="font-size:14px;color:#666;margin-bottom:8px;">已選擇的日期：</div>
              <div id="selected-dates-tags" style="display:flex;flex-wrap:wrap;gap:8px;">
                <span style="color:#999;font-size:14px;">尚未選擇日期</span>
              </div>
            </div>
          </div>
          
          <div style="display:flex;gap:8px;margin-top:24px;">
            <button type="submit" class="btn" id="event-submit-btn">儲存活動</button>
            <button type="button" id="cancel-event-form" class="btn ghost">取消</button>
          </div>
        </form>
      </div>
    </div>
  </main>
</body>
</html>

